.equity-calculator-container {
  width: 100%;
  margin: 0;
  padding: 0;
}

/* Container matching: bg-white rounded border border-gray-200 overflow-x-auto */
.spreadsheet-wrapper {
  background: #ffffff !important;
  border: 1px solid #e5e7eb !important;
  border-radius: 0.5rem !important;
  width: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  padding: 0 !important;
  margin: 0 !important;
  line-height: 0 !important;
  position: relative !important;
  overflow: hidden !important;
}

/* Scrollable container for spreadsheet */
.spreadsheet-scroll-container {
  flex: 1 1 auto !important;
  overflow-y: auto !important;
  overflow-x: auto !important;
  position: relative !important;
  /* Enable sticky positioning for child elements */
  -webkit-overflow-scrolling: touch !important;
}

/* Table matching: min-w-full divide-y divide-gray-200 */
.Spreadsheet {
  border: none !important;
  border-radius: 0 !important;
  overflow: visible !important;
  width: 100% !important;
  min-width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  line-height: 0 !important;
  /* Don't use position: relative as it can interfere with sticky children */
}

.Spreadsheet__table {
  border-collapse: separate !important;
  border-spacing: 0 !important;
  width: 100% !important;
  min-width: 100% !important;
  font-family: inherit !important;
  table-layout: auto !important;
  margin: 0 !important;
  padding: 0 !important;
  /* border-collapse: separate is required for sticky positioning to work */
}

/* Header row matching: bg-gray-50 */
.Spreadsheet thead,
.Spreadsheet__header {
  background-color: #ffffff !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 20 !important;
}

/* Make the first row sticky - header row stays at top when scrolling */
.spreadsheet-scroll-container .Spreadsheet tbody tr:first-child,
.spreadsheet-scroll-container .Spreadsheet__table tbody tr:first-child,
.single-click-edit .Spreadsheet tbody tr:first-child,
.single-click-edit .Spreadsheet__table tbody tr:first-child {
  position: -webkit-sticky !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 25 !important;
  background-color: #ffffff !important;
  isolation: isolate !important;
}

.spreadsheet-scroll-container .Spreadsheet tbody tr:first-child td,
.spreadsheet-scroll-container .Spreadsheet__table tbody tr:first-child td,
.spreadsheet-scroll-container .Spreadsheet tbody tr:first-child .Spreadsheet__cell,
.spreadsheet-scroll-container .Spreadsheet__table tbody tr:first-child .Spreadsheet__cell,
.single-click-edit .Spreadsheet tbody tr:first-child td,
.single-click-edit .Spreadsheet__table tbody tr:first-child td,
.single-click-edit .Spreadsheet tbody tr:first-child .Spreadsheet__cell,
.single-click-edit .Spreadsheet__table tbody tr:first-child .Spreadsheet__cell {
  background-color: #ffffff !important;
  font-weight: 600 !important;
  position: -webkit-sticky !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 25 !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important;
}

.Spreadsheet tbody {
  margin: 0 !important;
  padding: 0 !important;
  /* Don't set position to allow sticky children to work */
}


/* Header cells matching: px-4 py-3 text-left text-sm font-medium text-gray-900 border-r border-gray-200 */
.Spreadsheet th,
.Spreadsheet thead .Spreadsheet__cell {
  padding: 0.75rem 1rem !important;
  text-align: left !important;
  font-size: 1rem !important;
  font-weight: 600 !important;
  color: #111827 !important;
  background-color: #ffffff !important;
  border-right: none !important;
  border-bottom: 1px solid #e5e7eb !important;
  border-top: none !important;
  border-left: none !important;
  line-height: 1.5 !important;
  pointer-events: none !important;
  cursor: default !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 20 !important;
}

/* No border between Category and Importance columns */

.Spreadsheet th:last-child,
.Spreadsheet thead .Spreadsheet__cell:last-child {
  border-right: 0 !important;
}

/* Body cells matching: px-4 py-3 text-sm border-r border-gray-200 */
.Spreadsheet tbody .Spreadsheet__cell,
.Spreadsheet td {
  padding: 0.75rem 1rem !important;
  font-size: 0.875rem !important;
  color: #374151 !important;
  background-color: #ffffff !important;
  border-right: none !important;
  border-bottom: 1px solid #e5e7eb !important;
  border-top: none !important;
  border-left: none !important;
  text-align: left !important;
  line-height: 1.5 !important;
}

/* No border between Category and Importance columns */

.Spreadsheet tbody .Spreadsheet__cell:last-child,
.Spreadsheet td:last-child,
.Spreadsheet th:last-child {
  border-right: 0 !important;
}

/* Remove bottom border from last row to match divide-y behavior */
.Spreadsheet tbody tr:last-child .Spreadsheet__cell,
.Spreadsheet tbody tr:last-child td {
  border-bottom: 0 !important;
}

/* Ensure consistent row height */
.Spreadsheet tr {
  height: auto !important;
  margin: 0 !important;
  padding: 0 !important;
}

.Spreadsheet tbody tr {
  background-color: #ffffff !important;
}

/* Remove any vertical align issues */
.Spreadsheet td,
.Spreadsheet th,
.Spreadsheet__cell {
  vertical-align: middle !important;
}

/* Ensure no extra space from the wrapper */
.spreadsheet-wrapper::after {
  content: none !important;
  display: none !important;
}


.Spreadsheet__cell input {
  width: 100% !important;
  border: none !important;
  outline: none !important;
  padding: 0 !important;
  margin: 0 !important;
  font-size: 0.875rem !important;
  font-family: inherit !important;
  background: transparent !important;
  text-align: inherit !important;
  color: inherit !important;
  font-weight: inherit !important;
}

.Spreadsheet__cell input:focus {
  background-color: #f0f9ff !important;
  outline: 2px solid #3b82f6 !important;
  outline-offset: -2px !important;
}

/* Force left align for first column inputs */
.Spreadsheet__cell:first-child input,
.Spreadsheet td:first-child input,
.Spreadsheet tr td:first-of-type input,
.Spreadsheet tbody tr td:first-child input {
  text-align: left !important;
}

/* Extra override for tbody first cells */
.Spreadsheet tbody tr td:first-child,
.Spreadsheet tbody tr td:first-of-type {
  text-align: left !important;
}

/* Hide row index column (only the actual index, not data columns) */
.Spreadsheet tbody th {
  display: none !important;
}

/* First column (category names) */
.Spreadsheet tbody .Spreadsheet__cell:first-child:not(.group-header-cell),
.Spreadsheet tbody td:first-child:not(.group-header-cell),
.Spreadsheet tbody tr td:first-child:not(.group-header-cell) {
  font-weight: 500 !important;
  color: #111827 !important;
  background-color: #ffffff !important;
  pointer-events: none !important;
  cursor: default !important;
  position: sticky !important;
  left: 0 !important;
  z-index: 10 !important;
}

/* First header cell - needs both sticky top and left */
.Spreadsheet th:first-child,
.Spreadsheet thead .Spreadsheet__cell:first-child,
.Spreadsheet tbody tr:first-child td:first-child,
.Spreadsheet tbody tr:first-child .Spreadsheet__cell:first-child {
  position: sticky !important;
  left: 0 !important;
  top: 0 !important;
  z-index: 30 !important;
}

/* Group header cells - bold styling with smaller height */
.Spreadsheet .group-header-cell,
.Spreadsheet td.group-header-cell,
.Spreadsheet__cell.group-header-cell,
.Spreadsheet tbody .Spreadsheet__cell.group-header-cell,
.Spreadsheet tbody td.group-header-cell,
.spreadsheet-scroll-container .Spreadsheet .group-header-cell,
.spreadsheet-scroll-container .Spreadsheet td.group-header-cell,
.spreadsheet-scroll-container .Spreadsheet__cell.group-header-cell,
.single-click-edit .Spreadsheet .group-header-cell,
.single-click-edit .Spreadsheet td.group-header-cell,
.single-click-edit .Spreadsheet tbody td.group-header-cell {
  font-weight: 700 !important;
  color: #111827 !important;
  background-color: #ffffff !important;
  pointer-events: none !important;
  cursor: default !important;
  padding: 0.375rem 1rem !important;
  line-height: 1.25 !important;
  border-right: none !important;
}

/* Remove border between Category and Importance for group headers to make it look merged */
.Spreadsheet tbody .Spreadsheet__cell:first-child.group-header-cell,
.Spreadsheet tbody td:first-child.group-header-cell {
  border-right: none !important;
}

/* Hide the content (0's) in non-first-column group header cells */
.Spreadsheet .group-header-cell:not(:first-child),
.Spreadsheet td.group-header-cell:not(:first-child),
.Spreadsheet tbody td.group-header-cell:not(:first-child),
.Spreadsheet tbody .Spreadsheet__cell.group-header-cell:not(:first-child),
.spreadsheet-scroll-container .Spreadsheet .group-header-cell:not(:first-child),
.spreadsheet-scroll-container .Spreadsheet td.group-header-cell:not(:first-child),
.single-click-edit .Spreadsheet .group-header-cell:not(:first-child),
.single-click-edit .Spreadsheet td.group-header-cell:not(:first-child) {
  color: transparent !important;
  font-size: 0 !important;
}

/* Hide input elements in group header cells */
.Spreadsheet .group-header-cell:not(:first-child) input,
.Spreadsheet td.group-header-cell:not(:first-child) input,
.Spreadsheet tbody td.group-header-cell:not(:first-child) input,
.Spreadsheet__cell.group-header-cell:not(:first-child) input {
  display: none !important;
  visibility: hidden !important;
}

/* No border between Category and Importance columns for group headers */

/* First column group header cells - need sticky left positioning */
.Spreadsheet tbody tr td:first-child.group-header-cell,
.Spreadsheet tbody .Spreadsheet__cell:first-child.group-header-cell,
.single-click-edit .Spreadsheet tbody tr td:first-child.group-header-cell,
.single-click-edit .Spreadsheet tbody .Spreadsheet__cell:first-child.group-header-cell,
.spreadsheet-scroll-container .Spreadsheet tbody tr td:first-child.group-header-cell,
.spreadsheet-scroll-container .Spreadsheet tbody .Spreadsheet__cell:first-child.group-header-cell {
  position: sticky !important;
  left: 0 !important;
  z-index: 10 !important;
  background-color: #ffffff !important;
  font-weight: 700 !important;
}

/* Header cell styling using className */
.spreadsheet-scroll-container .Spreadsheet .header-cell,
.spreadsheet-scroll-container .Spreadsheet td.header-cell,
.spreadsheet-scroll-container td.header-cell {
  font-size: 1rem !important;
  font-weight: 600 !important;
  color: #111827 !important;
  background-color: #ffffff !important;
  pointer-events: none !important;
  cursor: default !important;
  position: -webkit-sticky !important;
  position: sticky !important;
  top: 0 !important;
  z-index: 20 !important;
  border-right: none !important;
}

/* No border between Category and Importance columns for header cells */

/* First header cell with header-cell class needs higher z-index */
.spreadsheet-scroll-container .Spreadsheet tbody tr:first-child td:first-child.header-cell,
.spreadsheet-scroll-container .Spreadsheet tbody tr:first-child .Spreadsheet__cell:first-child.header-cell {
  position: -webkit-sticky !important;
  position: sticky !important;
  z-index: 30 !important;
  left: 0 !important;
  top: 0 !important;
}

/* Category cell styling - but not if it's a group header */
.Spreadsheet .category-cell:not(.group-header-cell),
.Spreadsheet td.category-cell:not(.group-header-cell),
td.category-cell:not(.group-header-cell) {
  font-weight: 500 !important;
  color: #111827 !important;
  background-color: #ffffff !important;
  pointer-events: none !important;
  cursor: default !important;
}

/* Second column (importance) styling - center aligned */
.Spreadsheet__cell:nth-child(2),
.Spreadsheet td:nth-child(2) {
  text-align: center !important;
}

/* Cofounder columns (3+) - center aligned */
.Spreadsheet__cell:nth-child(n+3),
.Spreadsheet td:nth-child(n+3),
.Spreadsheet th:nth-child(n+3) {
  text-align: center !important;
}

/* Cofounder column inputs - center aligned */
.Spreadsheet__cell:nth-child(n+3) input,
.Spreadsheet td:nth-child(n+3) input {
  text-align: center !important;
}

/* Make cells editable on single click */
.Spreadsheet__cell--readonly {
  pointer-events: auto !important;
}

.Spreadsheet__cell:not(.Spreadsheet__cell--readonly) {
  cursor: text !important;
}

/* Ensure input is visible and clickable immediately */
.Spreadsheet__cell input {
  pointer-events: auto !important;
  cursor: text !important;
}

/* Make single click behave like double click for edit mode */
.single-click-edit .Spreadsheet__cell:not(.Spreadsheet__cell--readonly) {
  cursor: text !important;
}

.single-click-edit .Spreadsheet__cell:not(.Spreadsheet__cell--readonly):active {
  pointer-events: none !important;
}

/* Make group header rows (Inputs, Execution, Intangible) appear as merged cells with grey background */
.Spreadsheet tbody tr:nth-child(3) td,
.Spreadsheet tbody tr:nth-child(3) .Spreadsheet__cell,
.Spreadsheet__table tbody tr:nth-child(3) td,
.Spreadsheet__table tbody tr:nth-child(3) .Spreadsheet__cell,
.Spreadsheet tbody tr:nth-child(8) td,
.Spreadsheet tbody tr:nth-child(8) .Spreadsheet__cell,
.Spreadsheet__table tbody tr:nth-child(8) td,
.Spreadsheet__table tbody tr:nth-child(8) .Spreadsheet__cell,
.Spreadsheet tbody tr:nth-child(16) td,
.Spreadsheet tbody tr:nth-child(16) .Spreadsheet__cell,
.Spreadsheet__table tbody tr:nth-child(16) td,
.Spreadsheet__table tbody tr:nth-child(16) .Spreadsheet__cell {
  background-color: #f3f4f6 !important;
  border-right: none !important;
  border-left: none !important;
  padding: 0.375rem 1rem !important;
  line-height: 1.25 !important;
}

